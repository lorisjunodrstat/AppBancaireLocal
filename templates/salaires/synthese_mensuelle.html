{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Synthèse mensuelle</h1>

    <form method="get" class="mb-3" aria-label="Filtrer la synthèse par mois">
        <label for="mois" class="form-label">Sélectionnez un mois :</label>
        <select name="mois" id="mois" class="form-select w-auto d-inline-block" aria-describedby="moisHelp"
            onchange="this.form.submit()">
            <option value="">-- Tous les mois --</option>
            {% set month_names = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin',
            'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'] %}
            {% for m in range(1, 13) %}
            <option value="{{ m }}" {% if m==selected_month %}selected{% endif %}>
                {{ month_names[m-1] }}
            </option>
            {% endfor %}
        </select>
        <small id="moisHelp" class="form-text text-muted">Choisissez un mois pour filtrer les résultats</small>
    </form>

    <div class="table-responsive">
        <table class="table table-striped table-bordered align-middle">
            <thead class="table-light">
                <tr>
                    <th scope="col">Mois</th>
                    <th scope="col">Année</th>
                    <th scope="col" class="text-end">Heures réelles</th>
                    <th scope="col" class="text-end">Heures simulées</th>
                    <th scope="col" class="text-end">Salaire réel (CHF)</th>
                    <th scope="col" class="text-end">Salaire simulé (CHF)</th>
                </tr>
            </thead>
            <tbody>
                {% if syntheses %}
                {% for s in syntheses %}
                <tr>
                    <td>{{ month_names[s.mois - 1] }}</td>
                    <td>{{ s.annee }}</td>
                    <td class="text-end">{{ '%.2f'|format(s.heures_reelles or 0) }}</td>
                    <td class="text-end">{{ '%.2f'|format(s.heures_simulees or 0) }}</td>
                    <td class="text-end">{{ '%.2f'|format(s.salaire_reel or 0) }}</td>
                    <td class="text-end">{{ '%.2f'|format(s.salaire_simule or 0) }}</td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                    <td colspan="6" class="text-center fst-italic">Aucune synthèse disponible</td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}